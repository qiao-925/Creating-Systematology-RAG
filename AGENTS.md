# AI Agent 协作指南

## ⚠️ 核心规则：任务日志管理

### 任务日志必须保存在 agent-task-log/ 目录

**所有 AI Agent 执行任务的日志文档都必须保存在 `agent-task-log/` 目录中！**

#### 文件命名规范
```
agent-task-log/YYYY-MM-DD-N_任务名称_文档类型.md
```

**示例**：
- `agent-task-log/2025-10-14-1_RAG推理能力增强_快速摘要.md`
- `agent-task-log/2025-10-14-2_UI布局重构_实施总结.md`

#### 文档类型
- **快速摘要** - 任务的简要总结
- **详细过程** - 完整的实施过程记录
- **实施总结** / **完成总结** - 任务完成后的总结
- **实施方案** - 任务实施前的方案设计

#### 禁止行为
- ❌ 禁止在项目根目录创建任务总结文档
- ❌ 禁止在其他目录创建任务日志
- ❌ 禁止使用其他文件命名格式

---

## 🔧 开发规范

### 方案讨论
1. 如果我要求先讨论方案时，**不要着急修改代码**，直到方案确定才可以修改代码
2. 方案讨论需要在我们双方都没疑问的情况下才可以输出具体方案文档
3. 方案评估请**主动思考需求边界，合理质疑当下方案的完善性**
4. 方案需包含：
   - 重要逻辑的实现思路
   - 需求按技术实现的依赖关系拆解并排序
   - 输出修改或新增文件的路径
   - 输出测试要点

### 代码修改
5. **严格按步骤执行**，每次只专注当前讨论的步骤
   - 不允许跨步骤实现功能或"顺便"完成其他步骤任务
   - 每个步骤完成后必须明确汇报，等待 Review 确认后才能进入下一步

6. **最小改动原则** - 任何代码修改请始终遵守最小改动原则，除非我主动要求优化或重构

7. **参考现有业务** - 代码实现请先思考哪些业务可以参考或复用，尽可能参考现有业务的实现风格

8. **Bug修复策略** - 如果超过 2 次修复失败，请主动添加关键日志后再进行尝试修复

---

## 🎯 决策原则

**凡是在方案、编码过程遇到任何争议或不确定，必须在第一时间主动告知我由我做决策**

- 不要默认采用一种方案实现
- 重大决策必须让我确认
- 提供 2-3 个方案供选择
- 解释每个方案的优劣

---

## 🤝 协作要点

### Human 应该介入的时刻
1. **方案选择** - 多个可行方案，需要权衡
2. **架构决策** - 影响长期维护
3. **取舍判断** - 例如性能 vs 可维护性
4. **风险评估** - 涉及技术债务或临时方案

### Agent 应该自主完成
1. **问题诊断** - 自动尝试多种诊断方法（但失败 3 次需暂停）
2. **代码实现** - 按既定方案执行
3. **测试运行** - 持续验证
4. **文档记录** - 记录过程到 agent-task-log/

### Agent 工作原则
- ✅ 主动尝试多种方案（2-3次）
- ✅ 记录所有尝试过程（包括失败的）
- ✅ 提供选项而非单一方案
- ✅ 解释思考过程
- ❌ 超过 3 次失败应暂停并请求指导
- ❌ 不要过度生成文档
- ❌ 不要隐藏失败的尝试
- ❌ 重大决策不要独断专行

---

## 📂 项目结构

### 目录用途
- `agent-task-log/` - **所有AI任务日志文档存放处**（重要！）
- `src/` - 源代码
- `docs/` - 项目文档
- `tests/` - 测试代码
- `data/` - 数据文件
- `pages/` - Streamlit多页面应用

### 文档更新规则
- 修改代码后，同步更新相关文档（如 ARCHITECTURE.md、API.md 等）
- 重大变更需在 CHANGELOG.md 中记录
- 技术决策需在 DECISIONS.md 中说明

---

## 🧪 测试规范

- 代码实现完成后需要进行基本测试
- Bug修复超过2次失败时，先添加日志再修复
- 修复完成后主动清除调试日志

---

## 💬 语言规范

- Always respond in Chinese-simplified（始终使用简体中文回复）

---

**更新日期**: 2025-10-14  
**参考文档**: [人机协作范式](agent-task-log/人机协作范式.md)

