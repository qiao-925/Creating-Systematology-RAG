# 2026-01-24 【plan】智能问题生成 - 词云交互设计

**任务类型**: feature  
**日期**: 2026-01-24  
**任务编号**: #11  
**Agent**: Claude Opus 4.5

---

## Checkpoint 状态表

| CP | 阶段 | 状态 | 完成日期 |
|----|------|------|----------|
| CP1 | 关键词提取 | ⬜ 待开始 | - |
| CP2 | 词云 UI 组件 | ⬜ 待开始 | - |
| CP3 | LLM 问题生成 | ⬜ 待开始 | - |
| CP4 | 集成与测试 | ⬜ 待开始 | - |

---

## 背景与目标

### 背景

当前快速开始界面使用预设问题按钮，交互性不足，无法引导用户探索知识库内容。

### 设计思路

1. 从知识库提取关键词，展示为词云
2. 用户选择感兴趣的关键词（可多选）
3. 根据选中关键词，LLM 生成深度问题
4. 用户选择问题或直接提问

### 目标

- 提升用户探索知识库的兴趣
- 引导用户提出高质量问题
- 增强交互体验

---

## 设计方案

### 交互流程

```
┌─────────────────────────────────────────────┐
│              💡 探索知识库                    │
├─────────────────────────────────────────────┤
│                                             │
│    [RAG]  [架构]  [检索]  [向量]            │
│      [LLM]  [Embedding]  [重排序]           │
│    [索引]  [文档]  [分块]  [查询]            │
│                                             │
│  已选: RAG, 架构                             │
│                                             │
│  [✨ 生成问题]                               │
├─────────────────────────────────────────────┤
│  基于您的兴趣，推荐以下问题：                  │
│                                             │
│  💬 RAG 系统的整体架构是怎样的？              │
│  💬 如何设计可扩展的 RAG 架构？               │
│  💬 RAG 架构中各组件如何协作？                │
└─────────────────────────────────────────────┘
```

### 技术方案

| 模块 | 方案 | 说明 |
|------|------|------|
| 关键词提取 | TF-IDF / 文档标题提取 | 从索引中提取高频关键词 |
| 词云 UI | Streamlit + CSS | 用按钮模拟词云效果，支持点击选中 |
| 问题生成 | LLM + Prompt | 根据关键词 + 知识库上下文生成问题 |

---

## 实施步骤

### CP1: 关键词提取

**目标**：从知识库中提取有意义的关键词

**任务**：
1. 实现关键词提取器
   - 从文档标题提取
   - 从文档内容 TF-IDF 提取
   - 去重、过滤停用词
2. 缓存关键词（避免重复计算）

**预计文件改动**：
- 新增：`backend/business/rag_engine/processing/keyword_extractor.py`

---

### CP2: 词云 UI 组件

**目标**：实现可交互的词云展示

**任务**：
1. 使用 Streamlit 按钮模拟词云
   - 不同大小表示词频
   - 点击选中/取消
   - 支持多选
2. 展示已选关键词
3. "生成问题" 按钮

**预计文件改动**：
- 新增：`frontend/components/keyword_cloud.py`
- 修改：`frontend/components/quick_start.py`

---

### CP3: LLM 问题生成

**目标**：根据关键词生成深度问题

**任务**：
1. 设计 Prompt
   - 输入：关键词列表 + 知识库主题
   - 输出：3-5 个深度问题
2. 实现问题生成接口
3. 问题展示与选择

**预计文件改动**：
- 新增：`prompts/question/generate.txt`
- 新增：`backend/business/rag_engine/processing/question_generator.py`

---

### CP4: 集成与测试

**目标**：集成到快速开始界面

**任务**：
1. 替换原有快速开始组件
2. 测试完整流程
3. 优化交互体验

**预计文件改动**：
- 修改：`frontend/components/quick_start.py`
- 修改：`frontend/main.py`（如需要）

---

## 文件改动清单

| 操作 | 文件 | 说明 |
|------|------|------|
| 新增 | `backend/business/rag_engine/processing/keyword_extractor.py` | 关键词提取 |
| 新增 | `frontend/components/keyword_cloud.py` | 词云 UI 组件 |
| 新增 | `prompts/question/generate.txt` | 问题生成 Prompt |
| 新增 | `backend/business/rag_engine/processing/question_generator.py` | 问题生成器 |
| 修改 | `frontend/components/quick_start.py` | 集成词云组件 |

---

## 待决策

| 决策点 | 选项 | 当前状态 |
|--------|------|----------|
| 关键词来源 | 文档标题 / TF-IDF / 两者结合 | 待定 |
| 词云样式 | 纯按钮 / 自定义 HTML | 待定 |
| 关键词数量 | 10-20 个 | 待定 |

---

## 下一步

本计划暂时挂起，优先完成 UI 优化任务。完成后再启动此功能开发。
