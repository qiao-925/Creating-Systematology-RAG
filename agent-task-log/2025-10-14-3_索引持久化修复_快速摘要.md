# ç´¢å¼•æŒä¹…åŒ–ä¿®å¤ - å¿«é€Ÿæ‘˜è¦

**æ—¥æœŸ**: 2025-10-14  
**çŠ¶æ€**: âœ… ä»£ç ä¿®å¤å®Œæˆï¼Œå¾…æµ‹è¯•éªŒè¯

---

## ğŸ¯ é—®é¢˜

**ç—‡çŠ¶**: æ¯æ¬¡å¯åŠ¨éƒ½éœ€è¦é‡æ–°æ›´æ–° GitHub ä»“åº“

**æ ¹å› **: å‘é‡IDæœªè®°å½•åˆ°å…ƒæ•°æ® â†’ æ— æ³•è¯†åˆ«å·²ç´¢å¼•æ–‡ä»¶ â†’ å¢é‡æ›´æ–°å¤±æ•ˆ

---

## ğŸ”§ è§£å†³æ–¹æ¡ˆ

### æ ¸å¿ƒæ€è·¯
åœ¨ç´¢å¼•æ„å»ºåï¼Œé€šè¿‡ Chroma æŸ¥è¯¢è·å–å‘é‡IDï¼Œå¹¶è®°å½•åˆ°å…ƒæ•°æ®ã€‚

### å…³é”®ä¿®æ”¹

```python
# 1. æ·»åŠ æŸ¥è¯¢æ–¹æ³•
def _get_vector_ids_by_metadata(self, file_path: str):
    results = self.chroma_collection.get(where={"file_path": file_path})
    return results.get('ids', [])

# 2. ä¿®æ”¹è¿”å›å€¼
def build_index(...) -> Tuple[VectorStoreIndex, Dict[str, List[str]]]:
    # ... æ„å»ºç´¢å¼•
    vector_ids_map = {
        doc.metadata["file_path"]: self._get_vector_ids_by_metadata(...)
        for doc in documents
    }
    return self._index, vector_ids_map

# 3. è°ƒç”¨æ—¶ä¼ é€’
index, vector_ids_map = index_manager.build_index(documents)
metadata_manager.update_repository_metadata(
    ...,
    vector_ids_map=vector_ids_map  # âœ… å…³é”®
)
```

---

## ğŸ“ ä¿®æ”¹æ–‡ä»¶

- âœ… `src/indexer.py` - æ·»åŠ æŸ¥è¯¢æ–¹æ³•ï¼Œä¿®æ”¹3ä¸ªæ–¹æ³•è¿”å›å€¼ (+70è¡Œ)
- âœ… `app.py` - ä¿®æ”¹2å¤„è°ƒç”¨ (+20è¡Œ)
- âœ… `pages/1_âš™ï¸_è®¾ç½®.py` - ä¿®æ”¹3å¤„è°ƒç”¨ (+15è¡Œ)
- âœ… `main.py` - é€‚é…CLIè°ƒç”¨ (+3è¡Œ)

---

## ğŸ§ª å¿«é€ŸéªŒè¯

### 1. æ·»åŠ ä»“åº“
```bash
streamlit run app.py
# æ·»åŠ  GitHub ä»“åº“
# è§‚å¯Ÿ: "ğŸ“‹ å·²è®°å½• X ä¸ªæ–‡ä»¶çš„å‘é‡IDæ˜ å°„"
```

### 2. æ£€æŸ¥å…ƒæ•°æ®
```bash
cat data/github_metadata.json | python -m json.tool
# âœ… vector_ids æœ‰å†…å®¹ï¼ˆä¸æ˜¯ []ï¼‰
# âœ… last_commit_sha æœ‰å€¼ï¼ˆä¸æ˜¯ ""ï¼‰
```

### 3. é‡å¯éªŒè¯ï¼ˆæœ€å…³é”®ï¼‰
```bash
# å…³é—­åé‡å¯
streamlit run app.py
# ç‚¹å‡»"ğŸ”„ åŒæ­¥æ‰€æœ‰ä»“åº“"

# âœ… æˆåŠŸ: æç¤º"æ— å˜æ›´"
# âŒ å¤±è´¥: æç¤ºå¤§é‡"æ–°å¢"
```

---

## ğŸ“Š å¯¹æ¯”

### ä¿®å¤å‰
```json
{
  "vector_ids": [],           // âŒ
  "last_commit_sha": ""       // âŒ
}
```

### ä¿®å¤å
```json
{
  "vector_ids": ["uuid-001", "uuid-002"],  // âœ…
  "last_commit_sha": "a1b2c3d4..."         // âœ…
}
```

---

## ğŸ¯ é¢„æœŸæ•ˆæœ

- âœ… å…ƒæ•°æ®å®Œæ•´è®°å½•å‘é‡ID
- âœ… é‡å¯æ—¶ä¸å†é‡å¤ç´¢å¼•
- âœ… å¢é‡æ›´æ–°åªå¤„ç†å˜åŒ–çš„æ–‡ä»¶
- âœ… å¯åŠ¨å’ŒåŒæ­¥é€Ÿåº¦å¤§å¹…æå‡

---

## âš ï¸ ç°æœ‰æ•°æ®å¤„ç†

å¦‚æœå·²æœ‰ä»“åº“çš„ `vector_ids` ä¸ºç©ºï¼š

**æ–¹æ¡ˆA**ï¼ˆæ¨èï¼‰: åœ¨è®¾ç½®é¡µé¢åˆ é™¤æ—§ä»“åº“ï¼Œé‡æ–°æ·»åŠ   
**æ–¹æ¡ˆB**: ç‚¹å‡»"ğŸ”„ åŒæ­¥æ‰€æœ‰ä»“åº“"ï¼Œè‡ªåŠ¨å¡«å……å‘é‡ID

---

## ğŸ“š è¯¦ç»†æ–‡æ¡£

å®Œæ•´åˆ†æå’Œå®æ–½è¿‡ç¨‹è§: `2025-10-14-3_ç´¢å¼•æŒä¹…åŒ–ä¿®å¤_è¯¦ç»†è¿‡ç¨‹.md`

---

**ä¿®å¤å®Œæˆ**: 2025-10-14  
**å¾…éªŒè¯**: ç”¨æˆ·æµ‹è¯•

