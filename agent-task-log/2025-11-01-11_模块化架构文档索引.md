# 模块化架构 - 完整文档索引

> 本文档整理模块化架构相关的所有文档，便于查找和理解

---

## 📋 架构演进史

### Phase 1: 传统分层架构（2025-10前）

**特点**: 基础四层架构  
**文档**: 
- `docs/ARCHITECTURE.md`（历史版本）

**状态**: 已废弃

---

### Phase 2: 局部模块化（2025-10 ~ 2025-11-01）

**特点**: 部分模块实现可插拔，但缺少统一顶层设计

**文档**:
- `2025-11-01-1_模块化RAG核心实现_完成总结.md`
- `2025-11-01-2_模块化RAG与Embedding可插拔_合并方案.md`
- `2025-11-01-3_Embedding可插拔架构_阶段1完成.md`
- `2025-11-01-4_Embedding可插拔架构_完整实施总结.md`
- `2025-11-01-5_模块化RAG与Embedding可插拔_整体完成总结.md`
- `2025-11-01-6_重排序模块纳入模块化RAG_设计方案.md`
- `2025-11-01-7_可观测性纳入模块化RAG_设计方案.md`
- `2025-11-01-8_可观测性模块化_完整总结.md`

**已完成模块**:
- ✅ Embedding可插拔（`src/embeddings/`）
- ✅ DataSource可插拔（`src/data_source/`）
- ✅ Observer可观测性（`src/observers/`）
- ✅ ModularQueryEngine（`src/modular_query_engine.py`）
- ✅ ResponseFormatter（`src/response_formatter/`）

**状态**: 已完成，但架构不统一

---

### Phase 3: 模块化三层架构（2025-11-01起，当前方案）

**特点**: 完整的三层架构，统一设计模式，渐进式迁移

**核心文档**:
- `2025-11-01-2_模块化顶层设计_实施方案.md` - 顶层设计方案
- `2025-11-01-10_模块化架构整理与迁移指南_实施方案.md` - 迁移指南
- `docs/ARCHITECTURE.md` - 官方架构文档（已更新）

**迁移计划**:
- P0: 统一服务接口 + 前端迁移（待实施）
- P1: 流水线编排器 + 协议定义（待实施）
- P2: 模块注册中心 + 配置驱动（待实施）
- P3: 事件钩子 + 策略治理（待实施）

**状态**: 方案确立，开始渐进式迁移

---

## 📚 文档分类索引

### 1. 架构设计文档

| 文档 | 说明 | 状态 |
|------|------|------|
| `docs/ARCHITECTURE.md` | 官方架构文档（精简版，<300行） | ✅ 已更新 |
| `2025-11-01-2_模块化顶层设计_实施方案.md` | 详细的三层架构设计 | ✅ 完成 |

### 2. 迁移实施文档

| 文档 | 说明 | 状态 |
|------|------|------|
| `2025-11-01-10_模块化架构整理与迁移指南_实施方案.md` | 代码映射表、迁移路线 | ✅ 完成 |
| `2025-11-01-11_模块化架构确立与文档整理_完成总结.md` | 任务完成总结 | 🔄 待创建 |

### 3. 模块化RAG文档

| 文档 | 说明 | 状态 |
|------|------|------|
| `2025-11-01-1_模块化RAG核心实现_完成总结.md` | 检索策略模块化 | ✅ 完成 |
| `2025-11-01-6_重排序模块纳入模块化RAG_设计方案.md` | 重排序集成 | ✅ 完成 |
| `2025-11-01-7_可观测性纳入模块化RAG_设计方案.md` | 可观测性集成 | ✅ 完成 |

### 4. Embedding可插拔文档

| 文档 | 说明 | 状态 |
|------|------|------|
| `2025-11-01-2_模块化RAG与Embedding可插拔_合并方案.md` | 合并方案设计 | ✅ 完成 |
| `2025-11-01-3_Embedding可插拔架构_阶段1完成.md` | 阶段1实施 | ✅ 完成 |
| `2025-11-01-4_Embedding可插拔架构_完整实施总结.md` | 完整实施总结 | ✅ 完成 |

### 5. 整体完成总结

| 文档 | 说明 | 状态 |
|------|------|------|
| `2025-11-01-5_模块化RAG与Embedding可插拔_整体完成总结.md` | Phase 2 完成总结 | ✅ 完成 |
| `2025-11-01-8_可观测性模块化_完整总结.md` | 可观测性模块化总结 | ✅ 完成 |

---

## 🗂️ 代码模块索引

### 基础设施层

| 模块 | 路径 | 说明 | 文档 |
|------|------|------|------|
| Config | `src/config.py` | 配置管理 | - |
| Embedding | `src/embeddings/` | 向量化可插拔 | `2025-11-01-4` |
| DataSource | `src/data_source/` | 数据源可插拔 | - |
| Observer | `src/observers/` | 可观测性模块 | `2025-11-01-8` |
| DataParser | `src/data_parser/` | 文档解析 | - |
| Logger | `src/logger.py` | 日志系统 | - |
| Phoenix | `src/phoenix_utils.py` | 可观测性适配 | - |

### 业务层

| 模块 | 路径 | 说明 | 文档 |
|------|------|------|------|
| IndexManager | `src/indexer.py` | 索引管理 | - |
| QueryEngine | `src/query_engine.py` | 传统查询引擎 | - |
| ModularQueryEngine | `src/modular_query_engine.py` | 模块化查询引擎 | `2025-11-01-1` |
| ChatManager | `src/chat_manager.py` | 对话管理 | - |
| ResponseFormatter | `src/response_formatter/` | 响应格式化 | - |

### 前端层

| 模块 | 路径 | 说明 | 文档 |
|------|------|------|------|
| Web UI | `app.py` | Streamlit主界面 | - |
| CLI | `main.py` | 命令行工具 | - |
| 设置页 | `pages/1_⚙️_设置.py` | 系统设置 | - |
| UI组件 | `src/ui_components.py` | 复用组件 | - |

---

## 🎯 快速查找指南

### 想了解整体架构？
👉 `docs/ARCHITECTURE.md`（官方架构文档，<300行）

### 想了解迁移计划？
👉 `2025-11-01-10_模块化架构整理与迁移指南_实施方案.md`

### 想了解详细设计？
👉 `2025-11-01-2_模块化顶层设计_实施方案.md`

### 想了解已完成的模块化部分？
👉 `2025-11-01-5_模块化RAG与Embedding可插拔_整体完成总结.md`

### 想了解Embedding可插拔？
👉 `2025-11-01-4_Embedding可插拔架构_完整实施总结.md`

### 想了解可观测性模块化？
👉 `2025-11-01-8_可观测性模块化_完整总结.md`

---

## 📅 时间线

| 日期 | 事件 | 文档 |
|------|------|------|
| 2025-10-* | 传统分层架构时期 | - |
| 2025-11-01 | 模块化RAG核心实现 | `2025-11-01-1` |
| 2025-11-01 | 顶层设计方案确立 | `2025-11-01-2` |
| 2025-11-01 | Embedding可插拔完成 | `2025-11-01-3,4` |
| 2025-11-01 | Phase 2 整体完成 | `2025-11-01-5` |
| 2025-11-01 | 重排序与可观测性集成 | `2025-11-01-6,7,8` |
| 2025-11-01 | 架构文档整理与迁移指南 | `2025-11-01-10,11` |
| 未来 | P0-P3 渐进式迁移 | 待创建 |

---

**更新时间**: 2025-11-01  
**维护者**: AI Agent  
**版本**: v3.0（模块化三层架构）

