---
description: 方案讨论工作流 - 基于AGENTS.md
alwaysApply: false
---

# 方案讨论工作流

> 从 `AGENTS.md` 第 33-66 行转换的结构化工作流

---

## 🎯 工作流概述

**触发条件**: 用户要求"先讨论方案"

**核心原则**: **不要着急修改代码**，直到方案确定才可以修改代码

---

## 📋 执行步骤

### 阶段 1: 理解需求

#### 步骤 1.1: 需求分析
- 仔细阅读用户需求
- 识别核心功能点
- 明确边界条件和约束

#### 步骤 1.2: 需求边界思考
- **主动思考需求边界**
- **合理质疑当下方案的完善性**
- 识别潜在风险和问题点

---

### 阶段 2: 方案设计

#### 步骤 2.1: 生成方案选项
- 提供 **2-3 个可行方案**（不能只有单一方案）
- 每个方案包含：
  - 实现思路
  - 优缺点分析
  - 风险评估

#### 步骤 2.2: 方案文档要求

方案文档**必须包含**以下内容：

1. **重要逻辑的实现思路**
   - 核心算法或设计模式
   - 关键技术选型理由
   - 关键数据流和状态管理

2. **需求按技术实现的依赖关系拆解并排序**
   - 明确依赖关系（A → B → C）
   - 按依赖顺序排列实施步骤
   - 便于渐进式开发

3. **输出修改或新增文件的路径**
   - 列出所有需要修改的文件
   - 列出所有需要新增的文件
   - 说明每个文件的职责

4. **输出测试要点**
   - 单元测试要点
   - 集成测试要点
   - 边界条件测试
   - 异常情况测试
   - 利于需求完成后的自动化测试

---

### 阶段 3: 方案确认

#### 步骤 3.1: 等待双方确认
- **方案讨论需要在我们双方都没疑问的情况下才可以输出具体方案文档**
- 如有疑问，主动提出并讨论
- 不理解的点必须澄清

#### 步骤 3.2: 方案确认检查清单
- [ ] 用户已确认方案选择
- [ ] 双方对实现思路无疑问
- [ ] 依赖关系已明确
- [ ] 文件路径已确认
- [ ] 测试要点已明确

---

## 🚫 禁止行为

- ❌ **禁止在方案未确认时开始修改代码**
- ❌ **禁止跳过方案讨论直接实现**
- ❌ **禁止只提供单一方案**（必须提供2-3个选项）
- ❌ **禁止方案文档缺少必需内容**

---

## ✅ 验证检查

### 方案文档完整性检查
- [ ] 包含重要逻辑的实现思路
- [ ] 包含依赖关系拆解和排序
- [ ] 包含文件路径列表（修改+新增）
- [ ] 包含测试要点

### 方案确认检查
- [ ] 用户已明确选择方案
- [ ] 双方对方案无疑问
- [ ] 可以开始代码修改

---

## 🔄 与代码修改的衔接

### 方案确认后的流程
1. 方案确认 ✅
2. 开始代码实现（遵循 `development-workflow.mdc`）
3. 按步骤执行（不允许跨步骤）
4. 每个步骤完成后汇报

---

## 📚 相关规则

- 开发工作流：`development-workflow.mdc`
- 决策原则：`decision-making-principles.mdc`
- AGENTS.md 原始规则：第 33-66 行
