---
description: "Streamlit 原生组件优先使用规范 - 前端开发时优先使用原生组件"
autoAttach: true
globs:
  - "frontend/**/*.py"
  - "src/ui/**/*.py"
priority: 2
---

# Streamlit 原生组件优先使用规范

> 前端代码开发时，优先使用 Streamlit 原生组件，避免不必要的自定义组件。只有当原生组件无法完成业务需求时，才考虑自定义方案。

---

## 1. 核心原则

**⚠️ 强制要求：优先使用 Streamlit 原生组件**

- 所有前端功能实现**必须**首先考虑使用 Streamlit 原生组件
- 只有在原生组件**确实无法满足**业务需求时，才考虑自定义组件或第三方组件
- 使用自定义组件前，**必须**向用户说明原因并获得确认

---

## 2. Streamlit 原生组件清单

### 2.1 文本与显示组件

- `st.write()` / `st.markdown()` - 文本显示
- `st.title()` / `st.header()` / `st.subheader()` - 标题
- `st.caption()` / `st.text()` - 辅助文本
- `st.code()` - 代码块
- `st.latex()` - 数学公式
- `st.html()` - HTML 渲染（原生支持）

### 2.2 数据展示组件

- `st.dataframe()` - 交互式数据表
- `st.data_editor()` - 数据编辑器
- `st.table()` - 静态表格
- `st.metric()` - 指标显示
- `st.json()` - JSON 展示

### 2.3 输入组件

- `st.text_input()` / `st.text_area()` - 文本输入
- `st.number_input()` - 数字输入
- `st.slider()` / `st.select_slider()` - 滑块
- `st.selectbox()` / `st.multiselect()` - 选择框
- `st.checkbox()` / `st.radio()` / `st.toggle()` - 选择控件
- `st.date_input()` / `st.time_input()` - 日期时间
- `st.color_picker()` - 颜色选择
- `st.file_uploader()` - 文件上传
- `st.camera_input()` - 摄像头输入

### 2.4 布局组件

- `st.columns()` - 列布局
- `st.container()` - 容器
- `st.expander()` - 可展开区域
- `st.tabs()` - 标签页
- `st.sidebar` - 侧边栏

### 2.5 交互组件

- `st.button()` - 按钮
- `st.download_button()` - 下载按钮
- `st.link_button()` - 链接按钮
- `st.form()` / `st.form_submit_button()` - 表单
- `st.chat_input()` - 聊天输入（Streamlit 1.28+）
- `st.chat_message()` - 聊天消息（Streamlit 1.28+）

### 2.6 状态与反馈组件

- `st.status()` - 状态显示
- `st.progress()` - 进度条
- `st.spinner()` - 加载动画
- `st.balloons()` / `st.snow()` - 动画效果
- `st.toast()` - 提示消息
- `st.error()` / `st.warning()` / `st.info()` / `st.success()` - 消息提示

### 2.7 媒体组件

- `st.image()` - 图片
- `st.audio()` - 音频
- `st.video()` - 视频

### 2.8 其他原生功能

- `st.session_state` - 会话状态管理
- `st.query_params` - URL 查询参数
- `st.cache_data()` / `st.cache_resource()` - 缓存
- `st.rerun()` - 重新运行
- `st.stop()` - 停止执行
- `st.switch_page()` - 页面切换

---

## 3. AI Agent 行为要求

### 3.1 开发新功能时

1. **必须**首先查阅 [Streamlit API 参考](https://docs.streamlit.io/develop/api-reference)
2. **必须**优先尝试使用原生组件实现功能
3. **必须**验证原生组件是否满足业务需求
4. 如果原生组件无法满足需求，**必须**：
   - 明确说明原生组件的局限性
   - 说明业务需求的具体要求
   - 提出替代方案（自定义组件或第三方组件）
   - **等待用户确认**后再实施

### 3.2 代码审查时

1. **必须**检查是否使用了自定义组件或第三方组件
2. **必须**验证是否已尝试使用原生组件
3. 如果发现不必要的自定义组件，**必须**：
   - 指出可以替换的原生组件
   - 提供重构建议
   - 说明替换后的优势

### 3.3 遇到问题时

1. **必须**先查阅 Streamlit 官方文档
2. **必须**检查是否有原生组件可以解决
3. 如果原生组件确实无法解决，**必须**：
   - 向用户说明具体情况
   - 提供可行的解决方案
   - 等待用户决策

---

## 4. 决策流程

```
开始开发新功能
    ↓
查阅 Streamlit API 参考
    ↓
尝试使用原生组件实现
    ↓
原生组件是否满足需求？
    ├─ 是 → 使用原生组件 ✅
    └─ 否 → 向用户说明情况
            ↓
        等待用户确认
            ↓
        实施替代方案
```

---

## 5. 示例场景

### ✅ 正确做法

**场景**：需要显示一个可编辑的数据表

```python
# ✅ 使用原生组件
import streamlit as st

df = st.data_editor(
    my_dataframe,
    num_rows="dynamic",
    column_config={
        "price": st.column_config.NumberColumn(
            "Price (in USD)",
            min_value=0,
            format="$%d"
        )
    }
)
```

### ❌ 错误做法

**场景**：需要显示一个可编辑的数据表

```python
# ❌ 直接使用第三方组件，未尝试原生组件
from streamlit_aggrid import AgGrid

AgGrid(df, editable=True)  # 未先尝试 st.data_editor
```

### ⚠️ 需要用户确认的情况

**场景**：需要实现一个复杂的图表交互功能

```python
# 原生组件 st.plotly_chart 可以显示图表，但交互功能有限
# 业务需求：需要复杂的图表交互（如自定义工具、多图表联动等）
# 
# 建议方案：
# 1. 使用 st.plotly_chart（原生，但功能有限）
# 2. 使用第三方组件 streamlit-plotly-events（功能更强大）
#
# 请确认选择哪个方案？
```

---

## 6. 参考资料

- [Streamlit API 参考](https://docs.streamlit.io/develop/api-reference)
- [Streamlit 组件库](https://streamlit.io/components)
- 项目前端代码：`frontend/` 目录

---

## 7. 版本信息

- **最后更新**：2026-01-03
- **版本**：v1.0（初始版本）
