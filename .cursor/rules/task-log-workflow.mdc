---
description: 任务日志管理工作流 - 从AGENTS.md提取并结构化
alwaysApply: true
---

# 任务日志管理工作流

> 从 `AGENTS.md` 中的自然语言描述转换为结构化工作流

---

## 🔄 工作流分析

### 原始形式（AGENTS.md 自然语言）

```markdown
## ⚠️ 核心规则：任务日志管理

### 任务日志必须保存在 agent-task-log/ 目录
**所有 AI Agent 执行任务的日志文档都必须保存在 `agent-task-log/` 目录中！**

#### 文件命名规范
agent-task-log/YYYY-MM-DD-N_任务名称_文档类型.md

#### 文档类型
- **快速摘要** - 任务的简要总结
- **详细过程** - 完整的实施过程记录
- **实施总结** / **完成总结** - 任务完成后的总结
- **实施方案** - 任务实施前的方案设计

#### 禁止行为
- ❌ 禁止在项目根目录创建任务总结文档
- ❌ 禁止在其他目录创建任务日志
- ❌ 禁止使用其他文件命名格式
```

### 工作流特征识别

✅ **触发条件**: 执行任务后需要记录日志  
✅ **执行步骤**: 保存文件、命名、选择类型  
✅ **约束条件**: 禁止行为  
✅ **输入输出**: 任务信息 → 日志文件

---

## 📋 结构化工作流定义

### 工作流：任务日志记录

**触发时机**: 每次 AI Agent 完成任务或重要阶段

**执行步骤**:

#### 步骤 1: 确定日志文件位置
- **必须**: 保存到 `agent-task-log/` 目录
- **禁止**: 
  - ❌ 项目根目录
  - ❌ 其他任何目录

#### 步骤 2: 生成文件名称
按照格式：`YYYY-MM-DD-N_任务名称_文档类型.md`

**格式规则**:
- `YYYY-MM-DD`: 当前日期
- `N`: 当天第几个任务（1, 2, 3...）
- `任务名称`: 简短描述（5-10字）
- `文档类型`: 见步骤3

**示例**:
```
✅ agent-task-log/2025-11-02-1_Cursor规则设计_完成总结.md
✅ agent-task-log/2025-11-02-2_Bug修复_快速摘要.md
❌ 2025-11-02-1_任务.md  (错误：不在agent-task-log目录)
❌ agent-task-log/任务.md  (错误：不符合命名格式)
```

#### 步骤 3: 选择文档类型

根据任务阶段和内容，选择以下类型之一：

| 文档类型 | 使用场景 | 内容要求 |
|---------|---------|---------|
| **快速摘要** | 任务简要总结 | 1-2段，核心要点 |
| **详细过程** | 完整实施记录 | 包含时间线、思考过程、修改记录 |
| **实施总结** / **完成总结** | 任务完成后 | 成果、经验教训、后续计划 |
| **实施方案** | 任务实施前 | 方案设计、技术选型、实施步骤 |

#### 步骤 4: 完成优化分析（必须）

**任务完成后必须进行优化分析**：
- [ ] 完成代码质量分析
- [ ] 完成架构设计分析
- [ ] 完成性能分析（如适用）
- [ ] 完成测试分析
- [ ] 识别技术债务
- [ ] 排序优化优先级
- [ ] 制定优化计划

**详细要求**: 参考 `post-task-optimization.mdc` 规则

#### 步骤 5: 验证检查

**必须验证**:
- [ ] 文件保存在 `agent-task-log/` 目录
- [ ] 文件名符合命名规范
- [ ] 文档类型选择正确
- [ ] 内容完整（根据文档类型要求）
- [ ] **包含优化分析**（完成总结类型必须包含）

**禁止检查**:
- [ ] 不在项目根目录
- [ ] 不在其他目录
- [ ] 不使用其他命名格式

---

## 🔍 工作流对比分析

### 自然语言形式（AGENTS.md）

**优点**:
- ✅ 易于理解，阅读流畅
- ✅ 灵活性高，可以详细说明
- ✅ 适合人类阅读和讨论

**缺点**:
- ❌ 缺乏明确的执行步骤
- ❌ 不易被 AI 系统化执行
- ❌ 无法形成检查清单

### 结构化形式（.cursor/rules）

**优点**:
- ✅ 明确的步骤和检查点
- ✅ 可执行性强，易于自动化
- ✅ 可以形成验证清单
- ✅ 便于扩展和引用

**缺点**:
- ❌ 格式相对固定
- ❌ 可能显得过于机械

---

## 💡 最佳实践建议

### 建议 1: 两者结合使用

- **AGENTS.md**: 用于人类阅读，理解工作流的目的和原则
- **.cursor/rules**: 用于 AI 执行，提供结构化的步骤和检查清单

### 建议 2: 工作流转换模式

将自然语言规则转换为结构化工作流的模式：

```markdown
## 原始规则（自然语言）
[描述性的规则文本]

## 结构化工作流
### 触发条件
[何时触发]

### 执行步骤
1. [步骤1]
2. [步骤2]
3. [步骤3]

### 验证检查
- [ ] [检查项1]
- [ ] [检查项2]
```

### 建议 3: 示例工作流转换

更多 AGENTS.md 中的规则可以转换：

| AGENTS.md 规则 | 可转换的工作流 |
|---------------|---------------|
| 方案讨论流程 | `proposal-discussion-workflow.mdc` |
| 代码修改流程 | `code-modification-workflow.mdc` |
| Bug修复策略 | `bugfix-workflow.mdc` |
| 测试规范 | 已有 `testing-standards.mdc` |

---

## 🎯 结论

**是的，AGENTS.md 中的规则本质上就是工作流**，只是用自然语言描述：

1. **具备工作流核心要素**:
   - ✅ 触发条件（执行任务后）
   - ✅ 执行步骤（保存文件、命名、选择类型）
   - ✅ 约束条件（禁止行为）
   - ✅ 输入输出（任务信息 → 日志文件）

2. **区别在于形式**:
   - **AGENTS.md**: 自然语言，适合人类理解
   - **.cursor/rules**: 结构化，适合 AI 执行

3. **两者互补**:
   - 自然语言提供 **为什么** 和 **是什么**
   - 结构化工作流提供 **怎么做** 和 **检查什么**

---

## 📚 相关规则

- 任务日志管理（AGENTS.md）
- 开发工作流（development-workflow.mdc）
- 工作流定义指南（workflow-definitions.mdc）
