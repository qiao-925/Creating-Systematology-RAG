---
description: 任务日志管理工作流 - 从AGENTS.md提取并结构化
alwaysApply: false
---

# 任务日志管理工作流

> **核心原则**: 所有 AI Agent 执行任务的日志文档都必须保存在 `agent-task-log/` 目录中

**⚠️ 重要**: 任务日志是**第二步**（完成第一步任务执行汇报后立即执行）

---

## ✅ 任务完成后必须执行（核心要求，前 50 行）

### 任务日志记录检查清单

- [ ] **确定日志文件位置** - 保存到 `agent-task-log/` 目录
  - ❌ 禁止：项目根目录
  - ❌ 禁止：其他任何目录
- [ ] **生成文件名称** - 格式：`YYYY-MM-DD-N_任务名称_文档类型.md`
  - `YYYY-MM-DD`: 当前日期
  - `N`: 当天第几个任务（1, 2, 3...）
  - `任务名称`: 简短描述（5-10字）
  - `文档类型`: 快速摘要/详细过程/实施总结/完成总结/实施方案
- [ ] **选择文档类型** - 根据任务阶段选择
  - **快速摘要**: 任务简要总结（1-2段）
  - **详细过程**: 完整实施记录（时间线、思考过程、修改记录）
  - **实施总结/完成总结**: 任务完成后（成果、经验教训、后续计划，**必须包含优化分析**）
  - **实施方案**: 任务实施前（方案设计、技术选型、实施步骤）
- [ ] **完成优化分析**（完成总结类型必须）
  - [ ] 代码质量分析
  - [ ] 架构设计分析
  - [ ] 性能分析（如适用）
  - [ ] 测试分析
  - [ ] 可维护性分析
  - [ ] 技术债务识别
- [ ] **完成规则执行校验**（必须）
  - [ ] 执行规则执行校验（参考 `rule-execution-validator.mdc`）
  - [ ] **生成规则执行日志**（必须，检测规则系统是否良好运行）
  - [ ] 将规则执行校验结果包含在任务日志中
- [ ] **验证检查**
  - [ ] 文件保存在 `agent-task-log/` 目录
  - [ ] 文件名符合命名规范
  - [ ] 文档类型选择正确
  - [ ] 内容完整（根据文档类型要求）
  - [ ] **包含优化分析**（完成总结类型必须包含）
  - [ ] **包含规则执行校验结果**（必须包含，检测规则系统是否良好运行）

---

## 📋 文件命名示例

### ✅ 正确示例
- `agent-task-log/2025-11-02-1_Cursor规则设计_完成总结.md`
- `agent-task-log/2025-11-02-2_Bug修复_快速摘要.md`
- `agent-task-log/2025-11-02-3_新功能开发_实施方案.md`

### ❌ 错误示例
- `2025-11-02-1_任务.md` - 错误：不在agent-task-log目录
- `agent-task-log/任务.md` - 错误：不符合命名格式
- `agent-task-log/2025-11-02-1_任务.md` - 错误：缺少文档类型

---

## 🔍 文档类型选择指南

| 文档类型 | 使用场景 | 内容要求 |
|---------|---------|---------|
| **快速摘要** | 任务简要总结 | 1-2段，核心要点 |
| **详细过程** | 完整实施记录 | 包含时间线、思考过程、修改记录 |
| **实施总结** / **完成总结** | 任务完成后 | 成果、经验教训、后续计划，**必须包含优化分析** |
| **实施方案** | 任务实施前 | 方案设计、技术选型、实施步骤 |

---

## 📋 日志内容要求（完成总结类型）

### 必须包含的内容

- [ ] **任务概述** - 任务名称、目标、范围
- [ ] **关键步骤** - 按顺序列出关键实施步骤
- [ ] **实施方法** - 主要技术方案或方法
- [ ] **测试情况** - 测试类型、范围、结果
- [ ] **执行结果** - 完成状态、核心成果、遗留问题
- [ ] **优化分析**（必须） - 6个维度的优化分析
  - [ ] 代码质量分析
  - [ ] 架构设计分析
  - [ ] 性能分析（如适用）
  - [ ] 测试分析
  - [ ] 可维护性分析
  - [ ] 技术债务识别
- [ ] **规则执行校验结果**（必须） - 规则系统健康度检测
  - [ ] 规则执行情况（已执行/未执行）
  - [ ] 原因分析（如果规则未执行）
  - [ ] 补救措施（如果规则未执行）
  - [ ] 执行率统计
  - [ ] 规则系统健康度评估

---

## ⚠️ 禁止行为

- ❌ 禁止在项目根目录创建任务总结文档
- ❌ 禁止在其他目录创建任务日志
- ❌ 禁止使用其他文件命名格式
- ❌ 禁止跳过优化分析（完成总结类型必须包含）

---

## 🎯 执行顺序说明

**⚠️ 两个步骤必须顺序执行**：

1. **第一步：任务执行汇报**（见 AGENTS.md）
   - 在对话框中即时汇报，用于用户快速了解进度
   - **不保存文件**，仅在对话中显示
   - 完成后**必须继续执行第二步**

2. **第二步：保存任务日志**（当前步骤）
   - 保存到 `agent-task-log/` 目录的详细文档
   - **必须保存文件**，提供完整记录和存档
   - 包含更详细的过程、问题和优化分析

**两者关系**：
- 汇报提供快速概览（即时反馈）
- 日志提供详细记录（永久存档）
- **两者缺一不可，顺序执行**

---

## 📚 相关规则

- 任务执行汇报：`AGENTS.md`（第一步）
- 优化分析：`post-task-optimization.mdc`（完成总结必须包含）
- 开发工作流：`development-workflow.mdc`

---

**最后更新**: 2025-01-27  
**版本**: v2.0（检查清单格式）  
**目的**: 确保任务日志规范记录
