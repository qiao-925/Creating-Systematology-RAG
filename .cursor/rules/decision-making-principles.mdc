---
description: 决策原则与争议处理 - 基于AGENTS.md
alwaysApply: false
---

# 决策原则与争议处理

> 从 `AGENTS.md` 第 62-70 行转换的结构化规则

---

## 🎯 核心原则

**凡是在方案、编码过程遇到任何争议或不确定，必须在第一时间主动告知我由我做决策**

---

## 📋 需要用户决策的场景

### 1. 方案选择
**触发条件**: 多个可行方案，需要权衡

**处理流程**:
1. 列出所有可行方案（2-3个）
2. **不要默认采用一种方案实现**
3. 说明每个方案的优劣
4. **等待用户选择**

### 2. 架构决策
**触发条件**: 影响长期维护的架构选择

**处理流程**:
1. 说明架构影响范围
2. 分析长期维护成本
3. **重大决策必须让我确认**
4. 提供风险评估

### 3. 取舍判断
**触发条件**: 需要在不同维度间权衡（如性能 vs 可维护性）

**处理流程**:
1. 明确冲突的维度
2. 分析各方案的权衡点
3. 说明推荐方案的理由
4. **等待用户决策**

### 4. 风险评估
**触发条件**: 涉及技术债务或临时方案

**处理流程**:
1. 识别技术债务风险
2. 说明临时方案的影响
3. 提供长期方案建议
4. **等待用户确认是否接受风险**

### 5. 不确定性问题
**触发条件**: 任何不明确、有争议的点

**处理流程**:
1. **第一时间主动告知用户**
2. 说明不确定的原因
3. 提供可能的选项
4. **等待用户决策**

---

## 🔄 决策流程

```mermaid
graph TD
    A[遇到争议或不确定] --> B{是否属于<br/>重大决策?}
    B -->|是| C[主动告知用户]
    B -->|否| D{是否影响<br/>长期维护?}
    D -->|是| C
    D -->|否| E[提供2-3个方案]
    C --> F[等待用户决策]
    E --> F
    F --> G[按用户选择执行]
```

---

## ✅ 决策原则清单

### 必须遵循
- ✅ **遇到争议或不确定，第一时间主动告知用户**
- ✅ **不要默认采用一种方案实现**
- ✅ **重大决策必须让用户确认**
- ✅ **提供 2-3 个方案供选择**（不是单一方案）
- ✅ **解释每个方案的优劣**

### 禁止行为
- ❌ 不要独断专行做重大决策
- ❌ 不要隐藏不确定或争议点
- ❌ 不要只提供单一方案
- ❌ 不要在用户未确认时执行重大变更

---

## 🎯 决策优先级

### 高优先级（必须等待用户）
1. 架构决策（影响系统设计）
2. 技术选型（影响长期维护）
3. 性能 vs 可维护性取舍
4. 技术债务决策

### 中优先级（建议询问用户）
1. 实现方式选择（有多种方案）
2. 文件组织方式
3. 命名规范争议

### 低优先级（可自主判断）
1. 代码风格细节
2. 注释格式
3. 临时变量命名

---

## 📋 决策报告模板

当需要用户决策时，使用以下格式：

```markdown
## 需要决策的问题

**问题描述**: [简要描述问题]

**背景**: [为什么需要决策]

## 方案选项

### 方案 A: [方案名称]
**优点**:
- ...
**缺点**:
- ...
**风险评估**: [风险描述]

### 方案 B: [方案名称]
[同上]

## 推荐方案
基于[理由]，推荐方案[?]，但最终由您决定。

**请选择**: [等待用户输入]
```

---

## 🔗 与其他规则的整合

### 与方案讨论工作流的整合
- 方案讨论阶段必须遵循决策原则
- 方案选择需要用户确认

### 与自纠错机制的整合
- 自纠错失败后，必须主动告知用户
- 提供 2-3 个方案供选择
- 重大决策必须让用户确认

### 与协作要点的整合
- **Human 应该介入**: 方案选择、架构决策、取舍判断、风险评估
- **Agent 应该自主完成**: 代码实现（按既定方案）

---

## 📚 相关规则

- 方案讨论工作流：`proposal-discussion-workflow.mdc`
- 协作要点：`collaboration-guidelines.mdc`
- 开发工作流：`development-workflow.mdc`
- AGENTS.md 原始规则：第 62-70 行
